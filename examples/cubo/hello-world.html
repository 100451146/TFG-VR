<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TensorSpace - Hello World</title>
    <meta name="author" content="syt123450 / https://github.com/syt123450">

    <script src="../lib/three.min.js"></script>
    <script src="../lib/tween.min.js"></script>
    <script src="../lib/tf.min.js"></script>
    <script src="../lib/TrackballControls.js"></script>
    <script src="../../dist/tensorspace.min.js"></script>

    <script src="../lib/jquery.min.js"></script>

    <style>

        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }

        #container {
            width: 100%;
            height: 100%;
        }

    </style>

</head>
<body>

<div id="container"></div>

<script type="module">
    
    import * as THREE from "./three.module.js";
    import { OrbitControls } from "./OrbitControls.js";
    import { VRButton } from '../lib/VRButton.js';

    // create a scene
    let scene = new THREE.Scene();
    scene.background = new THREE.Color( 0x2a3b4c );
    
    // create a camera
    let camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight );
    camera.position.z = 5;
    
    // create a renderer
    let renderer = new THREE.WebGLRenderer();
    renderer.setSize( window.innerWidth, window.innerHeight );

    let modelContainer = document.getElementById( "container" );
    let model = new TSP.models.Sequential( modelContainer );

    model.add( new TSP.layers.GreyscaleInput() );
    model.add( new TSP.layers.Padding2d() );
    model.add( new TSP.layers.Conv2d() );
    model.add( new TSP.layers.Pooling2d() );
    model.add( new TSP.layers.Conv2d() );
    model.add( new TSP.layers.Pooling2d() );
    model.add( new TSP.layers.Dense() );
    model.add( new TSP.layers.Dense() );
    model.add( new TSP.layers.Output1d({
        outputs: ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9"]
    }) );

    model.load({
        type: "tensorflow",
        url: './convertedModel/model.json'
    });
    model.init( function() {

        $.ajax({
            url: "./data/5.json",
            type: 'GET',
            async: true,
            dataType: 'json',
            success: function (data) {

                model.predict( data );

            }
        });


    } );

    modelContainer.appendChild( VRButton.createButton( renderer ) );
    document.body.appendChild(modelContainer);

    // controles de la camara
    let controls = new OrbitControls( camera, renderer.domElement );
    controls.target.set( 0, 0, 0 );
    controls.update();

    // renderiza la escena
    function animate() {

        renderer.render( scene, camera );
        requestAnimationFrame( animate );

    }

    animate();
    
</script>

</body>
</html>
